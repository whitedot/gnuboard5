# Project Rules

## 1. 프로젝트 컨텍스트
- 본 프로젝트는 그누보드5 (GNUBoard5) 기반의 레거시 PHP 애플리케이션입니다.
- PSR-4 클래스 구조 대신 절차적 함수(lib/*.lib.php) 구조를 따릅니다.
- 데이터베이스 연동은 PDO/MySQLi 객체 직접 사용 대신 그누보드 래퍼 함수인 sql_query(), sql_fetch(), sql_fetch_array()를 사용합니다.
- 공통 파일: 로직 작성 시 항상 common.php 또는 _common.php가 include 되어 있다고 가정합니다.
- 커밋 스타일 접두어: 커밋 메시지 (커밋 메시지는 상세하게 기록합니다.)

## 2. 리팩토링 및 코드 스타일 가이드라인
- 객체지향(OOP) 변환 금지:
  - 기존 절차지향적 패턴을 유지하십시오. Class나 Interface를 새로 만들지 마십시오.
  - 기존 코드를 리팩토링할 때도 함수 분리 정도만 허용하며, 구조를 갈아엎지 마십시오.
- 네이밍 컨벤션:
  - 변수명과 함수명은 snake_case를 엄격히 준수하십시오. (ex: get_member_info)

## 3. 코드 안정성 및 보안
- SQL 인젝션 방지:
  - sql_query() 내에서 변수 사용 시 반드시 sql_real_escape_string() (혹은 숏컷 함수)으로 이스케이프 처리하십시오.
  - 예: sql_query(" select * from {$g5['member_table']} where mb_id = '".sql_real_escape_string($mb_id)."' ");
- 존재하지 않는 함수 호출 금지:
  - 그누보드 내장 함수(lib 폴더 내)인지 확인 후 사용하십시오.
  - function_exists() 체크 로직을 적극 활용하십시오.

## 4. 타입 힌팅 및 문서화
- PHPDoc 필수: 모든 함수에는 PHPDoc을 작성하여 파라미터와 리턴 타입을 명시하십시오.
- 전역 변수 타입 명시:
  - 함수 내에서 global $member; 등을 사용할 때는 반드시 .ide_helper/types.php에 정의된 Shape를 참조하여 주석을 다십시오.
  - 예: /** @var G5MemberShape $member */

## 5. IDE Helper 참조
- 전역 변수의 구조나 타입이 불확실할 경우 .ide_helper/types.php와 .ide_helper/globals.php를 참조하여 데이터 구조를 파악하십시오.

## 6. DB 스키마 및 타입 동기화
- 스키마 변경 시 타입 업데이트 필수:
  - CREATE TABLE 쿼리를 작성할 경우, 반드시 .ide_helper/types.php의 G5SystemShape 정의(배열 키)도 함께 업데이트해야 합니다.
  - ALTER TABLE 쿼리를 작성하거나 새로운 DB 컬럼을 추가하는 로직을 구현할 경우, 반드시 .ide_helper/types.php의 해당 Shape 정의(배열 키)도 함께 업데이트해야 합니다.
- 커스텀 컬럼 사용 주의:
  - 기본 컬럼 외에 사용자 정의 컬럼(예: mb_kakao_id)을 코드에서 사용할 때는, 먼저 .ide_helper/types.php에 해당 키가 정의되어 있는지 확인하십시오. 정의되어 있지 않다면 정의부터 추가하도록 사용자에게 제안하거나 직접 수정하십시오.